<!DOCTYPE html>
<!--
Copyright (C) 2017 ss

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<md-sidenav-container>
    <md-sidenav #sidenav opened="true" mode="side"
        [ngClass]="{'tm-sidenav': !isMobile(), 'tm-sidenav-mobile': isMobile(), 'ss-shadow': true}">

        <geocoder [parent]="this"></geocoder>

        <search-tab [mapComponent]="component"></search-tab>

        <button md-mini-fab color="primary" class="tm-map-control" style="top: 20px; right: 20px"
                (click)="closeMenu()" *ngIf="isMenuOpen"
                mdTooltip="{{'transport-map.controls.hide' | translate }}" mdTooltipPosition="below">
            <md-icon>chevron_left</md-icon></button>

    </md-sidenav>

    <md-card class="tm-map">
        <md-card-content>
            <div #map>

            </div>
        </md-card-content>
    </md-card>

    <!-- CONTROLS -->
    <button md-fab color="primary" class="tm-map-control" style="top: 25px; left: 25px"
            (click)="openMenu()" *ngIf="!isMenuOpen"
            mdTooltip="{{'transport-map.controls.search' | translate }}" mdTooltipPosition="below">
        <md-icon>widgets</md-icon>
    </button>

    <md-fab-speed-dial class="tm-map-control" style="top: 100px; right: 25px;"
                       direction="left" *ngIf="activeProfile && activeProfile.mapLayers && activeMapLayer.id != -1"
                       (selectAction)="changeMapLayer($event)">
        <md-fab-trigger mdTooltip="{{'transport-map.controls.layers' | translate }}"
                        mdTooltipPosition="below">
            <md-icon *ngIf="activeMapLayer">{{activeMapLayer.mdIcon}}</md-icon>
        </md-fab-trigger>

        <md-fab-actions>
            <md-fab-action *ngFor="let layer of activeProfile.mapLayers"
                mdTooltip="{{layer.name}}" mdTooltipPosition="below">
                <md-icon>{{layer.mdIcon}}</md-icon>
            </md-fab-action>
        </md-fab-actions>
    </md-fab-speed-dial>
    
    <button md-fab color="primary" class="tm-map-control" style="top: 25px; right: 25px"
            mdTooltip="{{'transport-map.controls.profile' | translate }}"
            mdTooltipPosition="below" *ngIf="profiles && profiles.length > 1"
            [mdMenuTriggerFor]="cityMenu">
        <md-icon>place</md-icon>
    </button>
    <md-menu #cityMenu="mdMenu">
        <button md-menu-item *ngFor="let profile of profiles" (click)="switchProfile(profile)">
                <span [translate]="'profile.' + profile.name"></span>
        </button>
    </md-menu>

</md-sidenav-container>

<waiting></waiting>
